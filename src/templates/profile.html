<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Profile page - Lookout</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;700&display=swap" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="/static/css/profile.css" />
  </head>
  <body>
    <div class="main-container">
      <div class="desktop">
          <div class="vector"></div>
        <div class="frame" id="header">
        <!-- Logo -->
        <div class="logo">
          <div class="logo-icon"></div>
          <span class="logo-text">LOOKOUT</span>
        </div>

        <!-- Hamburger menu (mobile only) -->
        <div class="hamburger" onclick="toggleMobileMenu()">
          <span></span>
          <span></span>
          <span></span>
        </div>

        <!-- Navigation (Desktop) -->
        <nav class="navbar-links desktop-only">
          <a href="/#about" class="nav-link">ABOUT</a>
          <a href="/#why-lookout" class="nav-link">WHY LOOKOUT</a>
          <a href="/#how-it-works" class="nav-link">HOW IT WORKS</a>
          <a href="/#try-it-out" class="nav-link">TRY IT OUT</a>
        </nav>

        <!-- Action Buttons (Desktop) -->
        <div class="header-right desktop-only">
            <div class="user-name">??</div>

            <a href="/profile" class="icon-circle" aria-label="Profile">
              <div class="profile-icon-gradient"></div>
            </a>


            <div class="icon logout-icon"></div>
        </div>
        <div class="user-name-mobile">??</div>
        <!-- Mobile Dropdown -->
        <div class="mobile-nav" id="mobileNav">
          <div style="display: flex; flex-direction: row; justify-content: space-between; width: 100%">
            <a href="/profile" class="icon-circle" aria-label="Profile">
              <div class="profile-icon-gradient"></div>
            </a>
          <div class="icon logout-icon"></div>
          </div>
          <a href="/#about">ABOUT</a>
          <a href="/#why-lookout">WHY LOOKOUT</a>
          <a href="/#how-it-works">HOW IT WORKS</a>
          <a href="/#try-it-out">TRY IT OUT</a>
        </div>
      </div>
<!--        WRITE YOUR CODE HERE  -->

                  <div class="container">
              <div class="profile-header">
<!--                <h2>Alua Kusman</h2>-->
                <h5>example@mail.com</h5>
                <h5>Member since: April 2025</h5>
              </div>

              <div class="stats-box">
                <div class="stat-item">
                  <div class="stat-icon"></div>
                  <span>12 videos analyzed</span>
                </div>
<!--                <div class="stat-item">-->
<!--                  <div class="stat-icon"></div>-->
<!--                  <span>4 documents downloaded</span>-->
<!--                </div>-->
              </div>

<!--              <div class="result-table">-->
              <div class="download-history-table">
                <table>
                  <thead>
                    <tr>
                      <th>File Name</th>
                      <th>Result</th>
                      <th>Confidence</th>
                      <th>Date & Time</th>
                    </tr>
                  </thead>
                  <tbody id="download-history-body">
<!--                    <tr>-->
<!--                      <td>myvideo.mp4</td>-->
<!--                      <td><span class="badge fake">FAKE</span></td>-->
<!--                      <td>83%</td>-->
<!--                      <td>10 April 2025, 14:32</td>-->
<!--                    </tr>-->
<!--                    <tr>-->
<!--                      <td>fake_video.mov</td>-->
<!--                      <td><span class="badge real">REAL</span></td>-->
<!--                      <td>85%</td>-->
<!--                      <td>9 April 2025, 11:35</td>-->
<!--                    </tr>-->
<!--                    <tr>-->
<!--                      <td>real-video.mp4</td>-->
<!--                      <td><span class="badge fake">FAKE</span></td>-->
<!--                      <td>92%</td>-->
<!--                      <td>8 April 2025, 09:45</td>-->
<!--                    </tr>-->
                  </tbody>
                </table>
<!--                <div class="download-btn-wrapper">-->
<!--                  <button class="btn-download">DOWNLOAD</button>-->
<!--                </div>-->
              </div>

              <a href="/upload">
                <button class="btn-analyze">ANALYZE NEW VIDEO</button>
              </a>

            </div>


<!--            FOOTER CODE START-->
            <footer class="footer">
              <div class="footer-background"></div>

              <div class="footer-content">
                <div class="footer-logo" >
                  <div class="footer-logo-icon"></div>
                  <span class="footer-logo-text">LOOKOUT</span>
                </div>

                <div class="footer-divider"></div>

                <div class="footer-column">
                  <h5><a href="/#about" style="text-decoration: none; color: white">ABOUT</a></h5>
                  <h5><a href="/#why-lookout" style="text-decoration: none; color: white">Why Lookout</a></h5>
                  <h5><a href="/#how-it-works" style="text-decoration: none; color: white">How it Works</a></h5>
<!--                  <h5><a href="#why-lookout" style="text-decoration: none; color: white">How To</a></h5>-->
                </div>

                <div class="footer-divider"></div>

                <div class="footer-column">
                  <h5><a href="/#faq" style="text-decoration: none; color: white">F.A.Q</a></h5>
                  <h5><a href="/#header" style="text-decoration: none; color: white">Sitemap</a></h5>
<!--                  <h5>Conditions</h5>-->
<!--                  <h5>Licenses</h5>-->
                </div>

                <div class="footer-divider"></div>

                <div class="footer-column">
                  <h5>Socialize with Lookout</h5>
                  <div class="social-icons">
                    <a href="https://www.facebook.com/lookoutapp" target="_blank" aria-label="Facebook">
                      <img src="https://codia-f2c.s3.us-west-1.amazonaws.com/image/2025-04-12/c7z2ZSvmCj.png" alt="Facebook" />
                    </a>
                    <a href="https://twitter.com/lookoutapp" target="_blank" aria-label="Twitter">
                      <img src="https://codia-f2c.s3.us-west-1.amazonaws.com/image/2025-04-12/i4Y310fnY6.png" alt="Twitter" />
                    </a>
                    <a href="https://www.linkedin.com/company/lookoutapp" target="_blank" aria-label="LinkedIn">
                      <img src="https://codia-f2c.s3.us-west-1.amazonaws.com/image/2025-04-12/bQOUO7mF4k.png" alt="LinkedIn" />
                    </a>
                    <a href="https://www.youtube.com/@lookoutapp" target="_blank" aria-label="YouTube">
                      <img src="https://codia-f2c.s3.us-west-1.amazonaws.com/image/2025-04-12/DpEvVZuXOE.png" alt="YouTube" />
                    </a>
                    <a href="https://www.instagram.com/lookoutapp" target="_blank" aria-label="Instagram">
                      <img src="https://codia-f2c.s3.us-west-1.amazonaws.com/image/2025-04-12/M2DwYnSJiQ.png" alt="Instagram" />
                    </a>
                    <a href="https://www.pinterest.com/lookoutapp" target="_blank" aria-label="Pinterest">
                      <img src="https://codia-f2c.s3.us-west-1.amazonaws.com/image/2025-04-17/ZZaQ5CYZ3H.png" alt="Pinterest" />
                    </a>
                  </div>
                  <div class="footer-button">PROTECT THE TRUTH</div>
                </div>
              </div>

              <hr class="footer-line" />
              <p class="copyright">2025© LOOKOUT - ALL RIGHTS RESERVED</p>
            </footer>
     </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>

    <script>
      function toggleMobileMenu() {
        const nav = document.getElementById("mobileNav");
        nav.classList.toggle("show");
      }

      // Optional: auto-close on link click
      document.querySelectorAll(".mobile-nav a").forEach(link =>
        link.addEventListener("click", () => {
          document.getElementById("mobileNav").classList.remove("show");
        })
      );
    </script>
<script>
document.addEventListener("DOMContentLoaded", async () => {
  const token = localStorage.getItem("access_token");
  if (!token) return window.location.href = "/login";

  // 1) Get user info
  const infoRes = await fetch("http://127.0.0.1:8000/api/v1/auth/info", {
    headers: { Authorization: `Bearer ${token}` }
  });
  if (!infoRes.ok) {
    localStorage.removeItem("access_token");
    return window.location.href = "/login";
  }
  const user = await infoRes.json();
  const userId = user.id;

  // 2) Render profile header
  document.querySelector(".user-name").textContent = user.username;
  document.querySelector(".user-name-mobile").textContent = user.username;
  document.querySelector(".profile-header h5:nth-child(1)").textContent = user.email;
  const joined = new Date(user.created_at);
  document.querySelector(".profile-header h5:nth-child(2)").textContent =
    `Member since: ${joined.toLocaleDateString("en-US", { year:'numeric', month:'long' })}`;

  // 3) Fetch analysis history
  const historyRes = await fetch(
    `http://127.0.0.1:8000/api/v1/analysis/users/${userId}/history`,
    { headers: { Authorization: `Bearer ${token}` } }
  );
  const tbody = document.getElementById("download-history-body");
  tbody.innerHTML = "";

  if (!historyRes.ok) {
    tbody.innerHTML = `
      <tr><td colspan="4" style="text-align:center;color:gray;">
        No videos analyzed yet.
      </td></tr>`;
    document.querySelector(".stats-box .stat-item span")
            .textContent = "0 videos analyzed";
    return;
  }

  const { data: history } = await historyRes.json();

  // 4) Update stats
  document.querySelector(".stats-box .stat-item span")
          .textContent = `${history.length} video${history.length===1?'':'s'} analyzed`;

  // 5) Populate table rows
  history.forEach(item => {
    // file_name might be the full S3 key—take only the basename
    const name = item.file_name?.split("/").pop() || "Untitled";

    const date = new Date(item.created_at + "Z").toLocaleString("en-US", {
      year: 'numeric',
      month: 'short',
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit'
    });

    const cls = item.prediction.toLowerCase() === "real" ? "real" : "fake";

    const row = `
      <tr>
        <td>${name}</td>
        <td><span class="badge ${cls}">${item.prediction.toUpperCase()}</span></td>
        <td>${item.confidence.toFixed(2)}%</td>
        <td>${date}</td>
      </tr>`;
    tbody.insertAdjacentHTML("beforeend", row);
  });
});

// Logout handler
document.querySelectorAll(".logout-icon").forEach(icon =>
  icon.addEventListener("click", () => {
    localStorage.removeItem("access_token");
    window.location.href = "/login";
  })
);
</script>


  </body>
</html>